generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Empresa {
  id           Int          @id @default(autoincrement())
  nombre       String
  rut          String       @unique
  email        String       @unique
  password     String
  trabajadores Trabajador[]

  createdAt    DateTime     @default(now())

  @@map("Empresa")
}

model Trabajador {
  id            Int             @id @default(autoincrement())
  nombre        String
  apellido      String
  empresaId     Int
  rut           String?         @db.VarChar(50)
  centroTrabajo String?
  certificaciones Certificacion[]

  empresa Empresa @relation(fields: [empresaId], references: [id])

  @@map("Trabajador")
}

model Certificacion {
  id               Int        @id @default(autoincrement())
  curso            String
  fechaEmision     DateTime
  fechaVencimiento DateTime
  trabajadorId     Int
  informe_url   String?   @db.Text

  // ðŸ‘‡ importante: ? + @map("codigo_verificacion")
  codigoVerificacion String? @unique @default(cuid()) @map("codigo_verificacion")
  alertaEnAtencionEnviada Boolean @default(false)
  alertaCriticoEnviada     Boolean @default(false)

  trabajador       Trabajador @relation(fields: [trabajadorId], references: [id])

  @@map("Certificacion")
}
